<!DOCTYPE html>
<html>
	<head>
		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

		<script src="js/jquery-1.8.3.min.js"></script>
<!------  Includes  ------>
		<link href="js/jquery.mobile-1.3.1/jquery.mobile-1.3.1.min.css" rel="stylesheet" />
		<script src="js/jquery.mobile-1.3.1/jquery.mobile-1.3.1.min.js"></script>
		
		<link href="js/mobiscroll.custom-2.4.4.min.css" rel="stylesheet" type="text/css" />
		<script src="js/mobiscroll.custom-2.4.4.min.js" type="text/javascript"></script>
		
		<link href="js/jplayer/skin/blue.monday/jplayer.blue.monday.css" rel="stylesheet" type="text/css" />
		<script src="js/jplayer/jquery.jplayer.min.js" type="text/javascript"></script>
		
		<script src="js/iscroll.js" type="text/javascript"></script>
		
		<script src="js/jQuery-file-exists.js" type="text/javascript"></script>
		
		<style type="text/css">
			@import "js/svg/jquery.svg.css";
		</style> 
		<script src="js/svg/jquery.svg.min.js" type="text/javascript"></script>

<!------  Languages  ------>
		<script src="js/lang/UI_translations.js" type="text/javascript"></script>

		<style type="text/css">
		  .exp {
				vertical-align: middle;
				display: table-cell;
				height:28px;
		  }
		  .exp span {
				display: inline-block;
		    float: left;
		    font-size : 12.5px;
				text-align: left;
				word-spacing:0px;
				vertical-align: middle;
				line-height: 14px;
				white-space : normal !important;
			}
			.exp_txt {
				font-weight: bold;
			}
			.exp_var {
				margin-left: 20px;
				font-style:italic;
				font-weight: normal;
			}
			.exp_trans {
				min-height: 20px;
				margin:0px;
				padding-top:0px;
				text-align:center;
				font-size: 16px;
				color: #333333;
				background-color: #FFFFFF;
				text-shadow: 0 0px 0 #000000 !important;
				border: 0px;
			}
			.exp_phon {
				height: 18px;
				margin:0px;
				padding-top:0px;
				text-align:center;
				font-size: 14px;
				color: #333333;
				background-color: #FFFFFF;
				text-shadow: 0 0px 0 #000000 !important;
				border: 0px;
			}
		
		  .list_option {
		    position: relative;
		    height: 100%;
		  }
		  .list_option img {
		    height: 20px;
		    display: block;
		    margin-top: 5px;
		  }
		  .list_option .img-cont {
		    width: 30px;
		    padding-left: 5px;
		    padding-right: 10px;
		    height: 20px;
		    text-align: center;
		    float: left;
		    position: relative;
		    top: 50%;
		    margin-top: -14px;
		  }
		  .list_option span {
		    float: left;
		    font-size : 20px;
		  }
		  
		  .list_share {
		  	padding: 0.6em 15px;
		  }
		  .list_share div {
		  	height: 32px; width: 200px;
		  }
		  .list_share span {
			  margin-left:40px;
			  position: absolute;
			  margin-top: 7px;
		  }
		  
		  .img_flag {
		  	padding-top: 2px;
		  }
		
			#list_exp {
				position:absolute; z-index:1;
				background:#fff;
				overflow:auto;
			}
			#scroller {
				position:absolute; z-index:1;
			/*	-webkit-touch-callout:none;*/
			/*	-webkit-tap-highlight-color:rgba(0,0,0,0);*/
				width:100%;
				padding:0;
			}
			.tab_exp {
				height: 40px;
			}
			.tab_exp div{
				height: 40px;
				display: table-cell;
				vertical-align: middle;
			}
			#scroller a{
				display: inline-block;
				padding: 2px 5px;
				white-space: normal;
				vertical-align: middle;
			}
			.tab_exp_txt {
				margin-left: 10px;
				font-weight: bold;
			}
			.tab_exp_var {
				margin-left: 20px;
				font-style:italic;
				font-weight: normal;
			}
		
		
			.ui-li-thumb, .ui-li-icon {
		    float: left;
		    left: 5px;
		    margin-right: 10px;
		    max-height: 60px; 
		    max-width: 60px;
		    vertical-align: middle;
		    top: 10px;
			}
			.ui-icon-help {
				background-image: url("ressources/webapp/icon_help.png");
				background-position: 3px 3px;
				background-size: 70%;
			}
			.ui-icon-play {
				background-image: url("ressources/webapp/icon_play.png");
				background-position: 3px 2px;
				background-size: 70%;
			}
			.ui-icon-stop {
				background-image: url("ressources/webapp/icon_stop.png");
				background-position: 3px 2px;
				background-size: 70%;
			}
		</style>
		<style type="text/css">				
			@media all{
				.i-txt { display:none; }
				.ios .dwhl { padding: 5px 0; }
				.dwwr { padding: 0 5px; }
		  	.dwi { padding: 0; margin: 0; }
		  	.dw-li { padding: 0 5px; }
		  	.ui-body-c { background-image: none;}
			}
		</style>
		
		<script type="text/javascript">
			var page = document.getElementById('page'),
		    ua = navigator.userAgent,
		    lang = navigator.language,
		    iphone = ~ua.indexOf('iPhone') || ~ua.indexOf('iPod'),
		    ipad = ~ua.indexOf('iPad'),
		    ios = iphone || ipad,
		    // Detect if this is running as a fullscreen app from the homescreen
		    fullscreen = window.navigator.standalone,
		    app = document.URL.indexOf( 'http://' ) === -1 && document.URL.indexOf( 'https://' ) === -1,
		    android = ~ua.indexOf('Android'),
		    lastWidth = 0;
			var deviceID = '';
			var ip = '68.147.52.158';
			$.getJSON("http://www.loecsen.com/OrizonFlash_V2/get_ip.php",
				function(data){
					ip = data.ip;
			});
			var lang_UI = lang.substr(0,2);
			var prd_id = 67;
			var from_lang_id;
			var from_lang_r2l;
			var from_lang_pos;
			var to_lang_id;
			var to_lang_r2l;
			var to_lang_pos;
			var title_id = 0;
			var title_text;
			var data_exp;
			var data_lang;
			var launch = true;

			switch(lang_UI)
			{
				case "en":
					from_lang_id = 2;
					from_lang_r2l = "N";
					to_lang_id = 3;
				break;
				case "fr":
					from_lang_id = 3;
					from_lang_r2l = "N";
					to_lang_id = 68;
				break;
				case "de":
					from_lang_id = 1;
					from_lang_r2l = "N";
					to_lang_id = 2;
				break;
				case "es":
					from_lang_id = 14;
					from_lang_r2l = "N";
					to_lang_id = 2;
				break;
				case "it":
					from_lang_id = 8;
					from_lang_r2l = "N";
					to_lang_id = 2;
				break;
				case "pt":
					from_lang_id = 16;
					from_lang_r2l = "N";
					to_lang_id = 2;
				break;
				default:
					lang_UI = "en";
					from_lang_id = 2;
					from_lang_r2l = "N";
					to_lang_id = 3;
				break;
			}
			
			var _w = Math.max( $(window).width(), $(window).height() );
			var _h = Math.min( $(window).width(), $(window).height() );
			// assume tablet view based upon display resolution
			var tabletView = (_w >= 1000 && _h >= 600);
			if ($(window).width() > $(window).height())
				tabletView = true;
			else
				tabletView = false;
		//	tabletView = false;
			//Orientation
			var orientation = window.orientation;
		
		
			var mode_player = true;
			var num_exp = 1;
			var cur_expID;
			var start_exp=0;
			var nb_exp;
			var nb_exp_total;
			var nb_elem2dl = 0;
			var jump = 5;

      var today = new Date();
      var today_ms = today.getTime();
      var exp_last_upd_ms = today_ms;
      
      var fromlang_chk_upd = false;
      var fromlang_do_upd = false;
      var tolang_chk_upd = false;
      var tolang_do_upd = false;
      var title_chk_upd = false;
      var title_do_upd = false;
      var exp_chk_upd = false;
      var exp_do_upd = false;
      var exp_chk_all = true;

      var ws_url = 'http://www.loecsen.com/OrizonFlash_V2/webservices/';
      var share_url = 'http://www.loecsen.com/travel/share.html';
      
//			var loaderZIPIMG = new ZipLoader('ressources/webapp/svg.zip');
//			var loaderZIPSND;

      var fileSystem;
      var knownfiles = [];
      var ProgressBar = false;
      var pg_value = 0;
			var myScroll;
			if (tabletView == true)
			{
				function Scroll_create() {
					myScroll = new iScroll('list_exp', {snap: false});
				}
				function Scroll_refresh() {
					myScroll.refresh();
				}
				function Scroll_destroy() {
					myScroll.destroy();
					myScroll = null;
				}
				function scrollToLine(i, autoplay) {
					if ((i > 0) && (typeof(myScroll)!='undefined'))
					{
						if (autoplay == true)
							myScroll.scrollToElement('li:nth-child(' + i + ')', 200);
					}
				}
				document.addEventListener('touchmove', function (e) { e.preventDefault(); }, false);
		//		document.addEventListener('DOMContentLoaded', function () { setTimeout(Scroll_create, 200); }, false);
			}
		
			function get_dataexp_pos(ar_data, str_search, fieldname){
				var found=false;
				var l = ar_data.length;
				for (var i = 0; i < l; i++)
				{
					if ((fieldname == "lang_id"))
					{
						if (ar_data[i].lang_id == str_search)
						{
							found = true;
							break;
						}
					}

					if ((fieldname == "exp") && (ar_data[i].id == str_search))
					{
						found = true;
						break;
					}
          var str = ar_data[i].image;
					if ((fieldname == "image") && (str.lastIndexOf(str_search) != -1))
					{
						found = true;
						break;
					}
          var str = ar_data[i].sound_tra;
					if ((fieldname == "sound_tra") && (str.lastIndexOf(str_search) != -1))
					{
						found = true;
						break;
					}
				}
				if (found == true)
		   		return i;
		   	else
		   		return -1;
			};


		$(function(){
			function translate_UI()
			{
				$("#TXT_MOB_6").html(g_UI_translated[lang_UI]["TXT_MOB_6"]);
				$("#TXT_MOB_7").html(g_UI_translated[lang_UI]["TXT_MOB_7"]);
				$("#TXT_MOB_8").html(g_UI_translated[lang_UI]["TXT_MOB_8"]);
				$("#TXT_MOB_9").html(g_UI_translated[lang_UI]["TXT_MOB_9"]);
				$("#TXT_MOB_10").html(g_UI_translated[lang_UI]["TXT_MOB_10"]);
				$("#TXT_MOB_11").html(g_UI_translated[lang_UI]["TXT_MOB_11"]);
				$("#TXT_MOB_12").html(g_UI_translated[lang_UI]["TXT_MOB_12"]);
				$("#TXT_MOB_13").html(g_UI_translated[lang_UI]["TXT_MOB_13"]);
				$("#TXT_MOB_14").html(g_UI_translated[lang_UI]["TXT_MOB_14"]);
				$("#TXT_MOB_19").html(g_UI_translated[lang_UI]["TXT_MOB_19"]);

				$("#btn_quizz .ui-btn-text").text(g_UI_translated[lang_UI]["TXT_MOB_5"]);
				$("#TXT_MOB_20 .ui-btn-text").text(g_UI_translated[lang_UI]["TXT_MOB_20"]);
				$("#TXT_MOB_23 .ui-btn-text").text(g_UI_translated[lang_UI]["TXT_MOB_23"]);

				$("#TXT_MOB_29").html(g_UI_translated[lang_UI]["TXT_MOB_29"]);
			}

			if (android)
				window.appRootDirName = "Android/data/com.loecsen.orizonlang";
			else
				window.appRootDirName = "com.loecsen.orizonlang";
			document.addEventListener("deviceready", onDeviceReady, false);
			$(window).bind( 'orientationchange', function(e)
			{
				if ($.event.special.orientationchange.orientation() == "portrait")
				{
					console.log("PORTRAIT");
				}
				else
				{
					console.log("PAYSAGE");
				}
				//window.location.reload();
			});

			
			function onDeviceReady()
			{
//				console.log("device is ready");
				translate_UI();
				deviceID = device.uuid;
				window.requestFileSystem  = window.requestFileSystem || window.webkitRequestFileSystem;
				window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, gotFS, fail);
			}
			
			function fail()
			{
				console.log("failed to get filesystem");
			}
			
			function gotFS(fs)
			{
        fileSystem = fs;
      
//console.log("filesystem got");
				fs.root.getDirectory(window.appRootDirName, {create : true, exclusive : false}, dirReady, fail);
			}
			
			function dirReady(entry)
			{
				window.appRootDir = entry;
//console.log(JSON.stringify(window.appRootDir));
				//ajax_upd_titles(prd_id, from_lang_id);
				$('#sel_exp').mobiscroll().image({
			    theme: 'ios',
			    lang: lang,
			    display: 'inline',
			    mode: 'scroller',
			    labels: ['Expressions'],
			    inputClass: 'i-txt',
			    rows: scroller_row,
			    width: scroller_width+10
				});
				ajax_get_fromlangs(prd_id, from_lang_id);
				timer_ads = window.setInterval(ajax_get_ads, 60000);
				ajax_get_ads();
			}

			function downloadFile(url, str_filename)
			{
console.log('Download start : ' + url);
				ft = new FileTransfer();
				ft.download(
					encodeURI(url),
					str_filename,
					function(entry) {
console.log('Download ended : ' + entry.name);
						var localfilepath = entry.fullPath;
            var localfilename = entry.name;
            var localfileext = localfilename.substr(localfilename.length - 3);
            localfileext = localfileext.toLowerCase();

            if (localfileext == "svg")
						{
              var pos = get_dataexp_pos(data_exp, localfilename, "image");
							data_exp[pos].downloadedImage = "OK";
              data_exp[pos].image = localfilepath;
						}
						if ((localfileext == "mp3") || (localfileext == "ogg"))
						{
							nb_elem2dl++;
console.log(Math.round((nb_elem2dl*100/(nb_exp_total))) + "% Sound " + "n" + nb_elem2dl + " download finished: " + localfilename);
							pg_value =  Math.round((nb_elem2dl*100/(nb_exp_total)));
//              $("#slider-mini").attr('value', Math.round((nb_elem2dl*100/(nb_exp))));
//							$("#slider-mini").slider('refresh');
              var pos = get_dataexp_pos(data_exp, localfilename, "sound_tra");
							data_exp[pos].downloadedSound_tra = "OK";
              data_exp[pos].sound_tra = localfilepath;
						}
						parseData(pos+1);
						//timer_load = setTimeout(parseData(pos+1), 50);
					},
					function(error) {
						console.log("download error source " + error.source);
						console.log("download error target " + error.target);
						console.log("Error code" + error.code);
/*
            var localfilename = error.target;
            var localfileext = localfilename.substr(localfilename.length - 3);
            localfileext = localfileext.toLowerCase();
            if (localfileext == "svg")
						{
							//nb_elem2dl++;
              var pos = get_dataexp_pos(data_exp, localfilename, "image");
							data_exp[pos].image_downloaded = "NOK";
						}
						if ((localfileext == "mp3") || (localfileext == "ogg"))
						{
							//nb_elem2dl++;
              var pos = get_dataexp_pos(data_exp, localfilename, "sound_tra");
							data_exp[pos].sound_tra_downloaded = "NOK";
						}
*/
						alert("download error source " + error.source + " error code" + error.code);
						hide_ProgressBar()
					}
				);
			}
			function download_JSON(url, str_filename, fct, lang_id, prd_id, from_lang_id, to_lang_id, title_id)
			{
				console.log('download ' + url);
				ft = new FileTransfer();
				ft.download(
					encodeURI(url),
					str_filename,
					function(entry) {
						console.log("download complete: " + entry.fullPath);
						if (fct == "fromlangs")
							ajax_get_fromlangs(prd_id, lang_id);
						if (fct == "titles")
							ajax_upd_titles(prd_id, lang_id);
						if (fct == "expressions")
							ajax_upd_expressions(prd_id, from_lang_id, to_lang_id, title_id);
							
					},
					function(error) {
						console.log("download error source " + error.source);
						console.log("download error target " + error.target);
						console.log("upload error code" + error.code);
            alert("download error source " + error.source + " error code" + error.code);
            hide_ProgressBar();
					}
				);
			}

      function show_selToLang()
      {
				$('#sel_to_lang').mobiscroll('show');
				$('.dwbw').css({'width': '100%'});
				$('.dwb-c').css({'display': 'none'});
			}
			
      function show_ProgressBar()
      {
        if (ProgressBar == false)
        {
          nb_elem2dl = 0;
          pg_value = 0
          $("#bar").hide();
          $("#pg_bar").show();
          $("#slider-mini").attr('value', 0);
          $("#slider-mini").slider('refresh');
	        ProgressBar = true;
	        timer_pg = window.setInterval(upd_ProgressBar,500);
        }
      }
      function upd_ProgressBar()
      {
//console.log("************* refresh *************");
				$("#slider-mini").attr('value', pg_value);
				$("#slider-mini").slider('refresh');

      }
      function hide_ProgressBar()
      {
        $("#pg_bar").hide();
        $("#bar").show();
        window.clearInterval(timer_pg);
        ProgressBar = false;
      }
      
			var img_ratio = 140/379; // TODO => Change for image detection !!!!
			var browser_width = $(window).innerWidth();
			var browser_height = $(window).innerHeight();
			var scroller_row = 3;
			if (browser_height > 420)
				scroller_row = 5;
			if (browser_height > 800)
				scroller_row = 11;
			if (iphone && !fullscreen && !app)
				browser_height += 60;
			var scroller_width = browser_width - 37;
			var scroller_r2l = false;
		  var exp_used = new Array();
		  var qcm_sel;
		  var qcm_num;
			var timer;
			var timer_load;
			var timer_ads;
			var timer_pg;
			var nb_good_answers=0;
			var nb_exp_used=0;
			if (tabletView == false)
			{
				var img_width = browser_width;
				var img_height = img_width*img_ratio;
				var bar_width = browser_width;
		
/* ADS */
				var cnt_padding = (((browser_height)  - (44 + 38 + img_height + 50 + 41 + (scroller_row * 30) + 18)) / 2);
/*NO ADS */
//				var cnt_padding = (((browser_height)  - (44 + 38 + img_height + 41 + (scroller_row * 30) + 18)) / 2);
        $('#cnt_exp').css({'padding-top': cnt_padding + 'px', 'padding-bottom': cnt_padding + 'px'});
      }
			else
			{
				var left_column_width = 400;
				var main_vertical_margins = 30;
				var img_width = browser_width - left_column_width;
				var img_height = img_width*img_ratio;
				var bar_width = browser_width;
				var lbl_trans_height = 30;
				var lbl_phon_height = 27;
				var main_row_height = img_height + lbl_trans_height + lbl_phon_height + (main_vertical_margins*2.5);
				
				var cnt_padding;
			}




			function ajax_get_ads()
			{
				if (ip == '68.147.52.158')
				{
					$.getJSON("http://www.loecsen.com/OrizonFlash_V2/get_ip.php",
						function(data){
							ip = data.ip;
					});
				}
//				var str_uri = "http://ads.mp.mydas.mobi/getAd?apid=134641&hdid=" + deviceID + "&ua=" + encodeURIComponent(ua) + "&uip=68.147.52.158" + ip;
				var str_uri = "http://ads.mp.mydas.mobi/getAd?apid=134641&hdid=" + deviceID + "&ua=iPhone&uip=" + ip;
			  $.ajax({
			    type: "GET",
			    url: str_uri,
			    cache: false,
			    dataType: "html",
			    success: function(data){
			    	if (tabletView == true)
			    	{
			    		$('#tab_ads').empty();
			    		$('#tab_ads').append(data);
			    		$('#tab_ads > a').click(function(){window.open(this.href,'_system'); return false;});
			    	}
			    	else
			    	{
			    		$('#ads').empty();
			    		$('#ads').append(data);
			    		$('#ads > a').click(function(){window.open(this.href,'_system'); return false;});
			    	}
			    }
				});
			}

			function ajax_get_fromlangs(prd_id, lang_id)
			{
//				var str_uri = window.appRootDir.fullPath + "/get_langs_from_" + prd_id + "_" + lang_id + ".json";
				var str_uri = window.appRootDir.fullPath + "/get_langs_from_" + lang_id + ".json";
				if (fromlang_chk_upd == false)
          fileSystem.root.getFile(str_uri, {create:false}, function(f){f.getMetadata(do_upd_fromlang, do_upd_fromlang_fail);}, do_upd_fromlang_fail);
        else
        {
					if ((str_uri.fileExists() == false) || (fromlang_do_upd == true))
					{
						fromlang_do_upd = false;
//						download_JSON(ws_url + "json_get_langs.php?pos=from&prd_id=" + prd_id + "&lang_id=" + lang_id, str_uri, "fromlangs", lang_id, prd_id);
						download_JSON(ws_url + "json_get_langs.php?app=1&lang_id=" + lang_id, str_uri, "fromlangs", lang_id, prd_id);
					}
					else
					{
					  $.ajax({
					    type: "GET",
					    url: str_uri,
					    cache: false,
					    contentType: "application/json; charset=utf-8",
					    dataType: "json",
					    success: onData_fromlangs
						});
					}
				}
			}
			function do_upd_fromlang(m)
			{
        fromlang_chk_upd = true;
        var date_tmp = new Date(m.modificationTime);
        var last_upd_ms = date_tmp.getTime();
        console.log("Last Update FromLang : " + last_upd_ms);
        if ((today_ms - last_upd_ms) > (2*3600*1000))
        {
          console.log("Do update FromLang");
          fromlang_do_upd = true;
        }
//fromlang_do_upd = true;
        ajax_get_fromlangs(prd_id, from_lang_id);
      }
			function do_upd_fromlang_fail(evt)
			{
        fromlang_chk_upd = true;
        ajax_get_fromlangs(prd_id, from_lang_id);
      }
      
			function onData_fromlangs(data)
			{
				$('#sel_from_lang').mobiscroll('destroy');
				$('#sel_to_lang').mobiscroll('destroy');
				$('#sel_from_lang li').remove();
				$('#sel_to_lang li').remove();
				data_lang=data;
				data=null;
				from_lang_pos = get_dataexp_pos(data_lang, from_lang_id, "lang_id");
				to_lang_pos = get_dataexp_pos(data_lang, to_lang_id, "lang_id");
				var l = data_lang.length;
				for (var i = 0; i < l; i++)
				{
					var tmp_id =data_lang[i].lang_id;
/*
          if (data[i].r2l == "Y")
            $('#sel_from_lang').append('<li data-val=" '+ tmp_id.toString() + '"><div class="list_option"><div class="img-cont"><img id="from_lang_icon_'+ tmp_id.toString() + '" src="images/flags/' + data[i].icon + '" class="r2l" /></div><span>' + data[i].lang_name + '</span></div></li>');
          else
            $('#sel_from_lang').append('<li data-val=" '+ tmp_id.toString() + '"><div class="list_option"><div class="img-cont"><img id="from_lang_icon_'+ tmp_id.toString() + '" src="images/flags/' + data[i].icon + '" /></div><span>' + data[i].lang_name + '</span></div></li>');
*/
//console.log("data_lang[to_lang_pos]._400ex >" + data_lang[to_lang_pos]._400ex + "< data_lang[to_lang_pos]._200ex >" + data_lang[to_lang_pos]._200ex + "< data_lang[i]._400ex >" + data_lang[i]._400ex + "< data_lang[i]._200ex >" + data_lang[i]._200ex);
//console.log(data_lang[i].lang_name + " >>> " + ((data_lang[to_lang_pos]._400ex == "true") && (data_lang[to_lang_pos]._200ex == "true")) + " >>> " + ((data_lang[to_lang_pos]._400ex == "true") && (data_lang[to_lang_pos]._200ex == "false") && (data_lang[i]._400ex == "true")) + " >>> " + ((data_lang[to_lang_pos]._400ex == "false") && (data_lang[to_lang_pos]._200ex == "true") && (data_lang[i]._200ex == "true")));

						if (((data_lang[to_lang_pos]._400ex == "true") && (data_lang[to_lang_pos]._200ex == "true")) || ((data_lang[to_lang_pos]._400ex == "true") && (data_lang[to_lang_pos]._200ex == "false") && (data_lang[i]._400ex == "true")) || ((data_lang[to_lang_pos]._400ex == "false") && (data_lang[to_lang_pos]._200ex == "true") && (data_lang[i]._200ex == "true")))
	          	$('#sel_from_lang').append('<li data-val=" '+ tmp_id.toString() + '"><div class="list_option"><div class="img-cont"><img id="from_lang_icon_'+ tmp_id.toString() + '" src="images/flags/' + data_lang[i].icon + '" class="' + data_lang[i].attrib + '"/></div><span>' + data_lang[i].lang_name + '</span></div></li>');

						if (((data_lang[from_lang_pos]._400ex == "true") && (data_lang[from_lang_pos]._200ex == "true")) || ((data_lang[from_lang_pos]._400ex == "true") && (data_lang[from_lang_pos]._200ex == "false") && (data_lang[i]._400ex == "true")) || ((data_lang[from_lang_pos]._400ex == "false") && (data_lang[from_lang_pos]._200ex == "true") && (data_lang[i]._200ex == "true")))
							$('#sel_to_lang').append('<li data-val=" '+ tmp_id.toString() + '"><div class="list_option"><div class="img-cont"><img id="to_lang_icon_'+ tmp_id.toString() + '" src="images/flags/' + data_lang[i].icon + '" class="' + data_lang[i].attrib + '"/></div><span>' + data_lang[i].lang_name + '</span></div></li>');

        }
			  $('#flag1').attr('src', $('#from_lang_icon_'+from_lang_id).attr('src'));
			  $('#flag2').attr('src', $('#to_lang_icon_'+to_lang_id).attr('src'));
			  $('#sel_from_lang').mobiscroll().image({
			    theme: 'default',
			    lang: 'fr',
			    setText: g_UI_translated[lang_UI]["TXT_MOB_21"],
			    cancelText: g_UI_translated[lang_UI]["TXT_MOB_22"],
			    display: 'modal',
			    mode: 'scroller',
			    r2l: scroller_r2l,
			    labels: [g_UI_translated[lang_UI]["TXT_MOB_1"]],
			    inputClass: 'i-txt',
			    rows: 5,
			    width: 200,
			    onSelect: function (valueText, inst){
				    var sel = $.trim($('#sel_from_lang').mobiscroll('getValue'));
				    var tmp_from_lang_pos = get_dataexp_pos(data_lang, sel, "lang_id");

						if ((data_lang[tmp_from_lang_pos]._400ex == "true") && (data_lang[to_lang_pos]._400ex == "true"))
							prd_id=67;
						if ((data_lang[tmp_from_lang_pos]._400ex == "false"))
							prd_id=14;
						if ((data_lang[to_lang_pos]._400ex == "false"))
							prd_id=14;
//		        var str_uri = window.appRootDir.fullPath + "/get_expressions_" + prd_id + "_" + from_lang_id + "_" + to_lang_id + "_" + title_id + ".json";
		        var str_uri = window.appRootDir.fullPath + "/get_expressions_" + prd_id + "_" + sel + "_" + to_lang_id + ".json";

						if (str_uri.fileExists() == false)
						{
					    $('#pup_newlang_title').addClass("from_lang");
					    $("#pup_newlang").popup("open");
					  }
					  else
					  {
				    	changeLang("from_lang");
				    }
				  }
			  });
			  $('#sel_to_lang').mobiscroll().image({
			    theme: 'default',
			    lang: 'fr',
			    setText: g_UI_translated[lang_UI]["TXT_MOB_21"],
			    cancelText: g_UI_translated[lang_UI]["TXT_MOB_22"],
			    display: 'modal',
			    mode: 'scroller',
			    r2l: scroller_r2l,
			    labels: [g_UI_translated[lang_UI]["TXT_MOB_2"]],
			    inputClass: 'i-txt',
			    rows: 5,
			    width: 200,
			    onSelect: function (valueText, inst){
				    var sel = $.trim($('#sel_to_lang').mobiscroll('getValue'));
				    var tmp_to_lang_pos = get_dataexp_pos(data_lang, sel, "lang_id");

				    if ((data_lang[from_lang_pos]._400ex == "true") && (data_lang[tmp_to_lang_pos]._400ex == "true"))
							prd_id=67;
						if ((data_lang[from_lang_pos]._400ex == "false"))
							prd_id=14;
						if ((data_lang[tmp_to_lang_pos]._400ex == "false"))
							prd_id=14;
//		        var str_uri = window.appRootDir.fullPath + "/get_expressions_" + prd_id + "_" + from_lang_id + "_" + to_lang_id + "_" + title_id + ".json";
		        var str_uri = window.appRootDir.fullPath + "/get_expressions_" + prd_id + "_" + from_lang_id + "_" + sel + ".json";

						if ((str_uri.fileExists() == false) && (launch == false))
						{
					    $('#pup_newlang_title').addClass("to_lang");
					    $("#pup_newlang").popup("open");
					  }
					  else
					  {
					  	launch=false;
				    	changeLang("to_lang");
						}
				  },
				  onClose: function (valueText, inst){
						if (launch == true)
						{
							setTimeout(show_selToLang, 50);
						}
				  }
			  });
			  //ajax_upd_expressions(prd_id, from_lang_id, to_lang_id, title_id);
			  ajax_upd_titles(prd_id, from_lang_id);
			}


      function changeLang(type)
      {
      	if (type == "from_lang")
      	{
			    var sel = $.trim($('#sel_from_lang').mobiscroll('getValue'));
			    from_lang_id = sel;
			    $('#flag1').attr('src', $('#from_lang_icon_'+sel).attr('src'));
          if ($('#from_lang_icon_'+sel).hasClass('r2l'))
            from_lang_r2l="Y";
          else
            from_lang_r2l="N";
          exp_chk_all = true;
					//ajax_upd_titles(prd_id, sel);
					ajax_get_fromlangs(prd_id, from_lang_id);
      	}
      	else
     		{
			    var sel = $.trim($('#sel_to_lang').mobiscroll('getValue'));
			    to_lang_id = sel;
			    $('#flag2').attr('src', $('#to_lang_icon_'+sel).attr('src'));
			    exp_chk_all = true;
					ajax_get_fromlangs(prd_id, from_lang_id);
//					ajax_upd_expressions(prd_id, from_lang_id, to_lang_id, title_id);
     		}
      }



			function ajax_upd_titles(prd_id, lang_id)
			{
				if ((data_lang[from_lang_pos]._400ex == "true") && (data_lang[to_lang_pos]._400ex == "true"))
					prd_id=67;
				if ((data_lang[from_lang_pos]._400ex == "false"))
					prd_id=14;
				if ((data_lang[to_lang_pos]._400ex == "false"))
					prd_id=14;
        var str_uri = window.appRootDir.fullPath + "/get_titles_" + prd_id + "_" + lang_id + ".json";
        if (title_chk_upd == false)
          fileSystem.root.getFile(str_uri, {create:false}, function(f){f.getMetadata(do_upd_title, do_upd_title_fail);}, do_upd_title_fail);
        else
        {
	        show_ProgressBar();
					if ((str_uri.fileExists() == false) || (title_do_upd == true))
					{
						title_do_upd = false;
						download_JSON(ws_url + "json_get_titles.php?prd_id=" + prd_id + "&lang_id=" + lang_id, str_uri, "titles", lang_id, prd_id);
					}
					else
					{
				    $.ajax({
				      type: "GET",
				      url: str_uri,
				      cache: false,
				      contentType: "application/json; charset=utf-8",
				      dataType: "json",
				      success: onData_Titles
				    });
				  }
				}
			}
			function do_upd_title(m)
			{
        title_chk_upd = true;
        var date_tmp = new Date(m.modificationTime);
        var last_upd_ms = date_tmp.getTime();
        console.log("Last Update Titles : " + last_upd_ms);
        if ((today_ms - last_upd_ms) > (2*3600*1000))
        {
          console.log("Do update Title");
          title_do_upd = true;
        }
//title_do_upd = true;
        ajax_upd_titles(prd_id, from_lang_id);
      }
			function do_upd_title_fail(evt)
			{
        title_chk_upd = true;
        ajax_upd_titles(prd_id, from_lang_id);
      }
			function onData_Titles(data)
			{
				$('#sel_title').mobiscroll('destroy');
				$('#sel_title li').remove();
				var l = data.length;
				for (var i = 0; i < l; i++)
				{
//					if (((title_id <= 0) && (i == 0)) || (title_id == data[i].title_id))
					if ((i == 0) || (title_id == data[i].title_id))
					{
						title_id = data[i].title_id;
						title_text = data[i].name;
						$("#top_title").html(title_text);
					}
					var tmp_id = data[i].title_id;
					$('#sel_title').append('<li data-val=" '+ tmp_id.toString() + '"><div class="list_option"><span id="title_' + tmp_id.toString() + '">' + data[i].name + '</span></div></li>');
				}
			  $('#sel_title').mobiscroll().image({
			    theme: 'default',
			    lang: 'fr',
			    setText: g_UI_translated[lang_UI]["TXT_MOB_21"],
			    cancelText: g_UI_translated[lang_UI]["TXT_MOB_22"],
			    display: 'modal',
			    mode: 'scroller',
			    r2l: scroller_r2l,
			    labels: [g_UI_translated[lang_UI]["TXT_MOB_3"]],
			    inputClass: 'i-txt',
			    rows: 5,
			    width: 200,
			    onSelect: function (valueText, inst){
				    var sel = $('#sel_title').mobiscroll('getValue');
				    title_id = $.trim(sel);
				    exp_chk_all = false;
				    $("#top_title").html($("#title_" + title_id).html());
				    ajax_upd_expressions(prd_id, from_lang_id, to_lang_id, title_id);
				  }
			  });
				//ajax_get_fromlangs(prd_id, from_lang_id);
				//ajax_get_tolangs(prd_id, from_lang_id);
				
				if (launch == true)
				{
					$('#sel_to_lang').mobiscroll('show');
					$('.dwbw').css({'width': '100%'});
					$('.dwb-c').css({'display': 'none'});
				}
				else
				{
					$('.dwbw').css({'width': '50%'});
					$('.dwb-c').css({'display': 'inline-block'});
					ajax_upd_expressions(prd_id, from_lang_id, to_lang_id, title_id);
				}
			}



			function ajax_upd_expressions(prd_id, from_lang_id, to_lang_id, title_id)
			{
				if ((data_lang[from_lang_pos]._400ex == "true") && (data_lang[to_lang_pos]._400ex == "true"))
					prd_id=67;
				if ((data_lang[from_lang_pos]._400ex == "false"))
					prd_id=14;
				if ((data_lang[to_lang_pos]._400ex == "false"))
					prd_id=14;
//        var str_uri = window.appRootDir.fullPath + "/get_expressions_" + prd_id + "_" + from_lang_id + "_" + to_lang_id + "_" + title_id + ".json";
        var str_uri = window.appRootDir.fullPath + "/get_expressions_" + prd_id + "_" + from_lang_id + "_" + to_lang_id + ".json";
        if (exp_chk_upd == false)
          fileSystem.root.getFile(str_uri, {create:false}, function(f){f.getMetadata(do_upd_exp,fail);},do_upd_exp_fail);
        else
        {
          show_ProgressBar();
          if ((str_uri.fileExists() == false) || (exp_do_upd == true))
          {
            exp_do_upd = false;
//            download_JSON(ws_url + "json_get_expressions.php?prd_id=" + prd_id + "&from_lang_id=" + from_lang_id + "&to_lang_id=" + to_lang_id + "&title_id=" + title_id, str_uri, "expressions", -1, prd_id, from_lang_id, to_lang_id, title_id);
            download_JSON(ws_url + "json_get_expressions.php?prd_id=" + prd_id + "&from_lang_id=" + from_lang_id + "&to_lang_id=" + to_lang_id + "&title_id=0", str_uri, "expressions", -1, prd_id, from_lang_id, to_lang_id, title_id);
          }
          else
          {
            $.ajax({
			        type: "GET",
			        url: str_uri,
			        cache: false,
			        contentType: "application/json; charset=utf-8",
			        dataType: "json",
			        success: onData_Expressions
			      });
          }
			  }
			}
			function do_upd_exp(m)
			{
        exp_chk_upd = true;
        var date_tmp = new Date(m.modificationTime);
        exp_last_upd_ms = date_tmp.getTime();
console.log("Last Update : " + exp_last_upd_ms);
        if ((today_ms - exp_last_upd_ms) > (2*3600*1000))
        {
console.log("Do update");
          exp_do_upd = true;
        }
//exp_do_upd = true;
        ajax_upd_expressions(prd_id, from_lang_id, to_lang_id, title_id);
      }
			function do_upd_exp_fail(evt)
			{
        exp_chk_upd = true;
        ajax_upd_expressions(prd_id, from_lang_id, to_lang_id, title_id);
      }

			
      function onData_Expressions(data)
			{
        if (typeof(data) != "undefined")
        {
          data_exp = data;
          nb_exp_total = data_exp.length;
          num_exp = 1;
//          cur_expID = data_exp[0].id;
//listFiles();
          parseData(0);
        }
			}

      function listFiles()
      {
				var reader = window.appRootDir.createReader();
				reader.readEntries(function(d){
					gotFiles(d);
				},fail);
      }
      function gotFiles(entries)
      {
console.log("The dir has "+entries.length+" entries.");
				for (var i=0; i<entries.length; i++) {
console.log(entries[i].name+' dir? '+entries[i].isDirectory);
					knownfiles.push(entries[i].name);
				}
    	}      

      
      
      
      
      function checkIfFileExists(path, url, pos, type)
      {
    	  if (data_exp[pos].downloadedSound_tra != "OK")
    		{
	    	  if (android)
	    		{
	    		  window.resolveLocalFileSystemURI(path,
							function (fileEntry) {
	//console.log(">>>> " + fileEntry.name);
						  	fileEntry.file(
						  			function(file){
						  				if (type == "sound_tra")
						  				{
									    	if (file.size >= data_exp[pos].sound_tra_size)
									    	{
									    		if (data_exp[pos].downloadedSound_tra == "downloading")
									    		{
									    			nb_elem2dl++;
									    			data_exp[pos].downloadedSound_tra = "OK";
	//console.log("Downloaded: " + path + " > " + file.size);
									    		}
									    	}
									    	else
									    	{
									    		//PAS LA BONNE TAILLE => ON RECHARGE
										    	if (file.size != data_exp[pos].sound_tra_size)
										    	{
										    		if (data_exp[pos].downloadedSound_tra != "downloading")
										    		{
										    			nb_elem2dl--;
										    			data_exp[pos].downloadedSound_tra = "downloading";
	//console.log("---### Re-Download: " + path + " > " + file.size);
															downloadFile(url, path);
										    		}
										    	}
									    	}
						  				}
									},
									function (error)
									{
	//console.log("ERROR GETTING FILE INFO : " + error.code);
									}
								);
							},
							function (error)
							{
	//console.log("NOT EXISTS 1 : " + path);
							}
						);
	    		}
	    	  else
	    		{
		    	  fileSystem.root.getFile(path, {create: false},
							function (fileEntry) {
	console.log(">>>> " + fileEntry.name);
						  	fileEntry.file(
						  			function(file){
						  				if (type == "sound_tra")
						  				{
									    	if (file.size >= data_exp[pos].sound_tra_size)
									    	{
									    		if (data_exp[pos].downloadedSound_tra == "downloading")
									    		{
									    			nb_elem2dl++;
									    			data_exp[pos].downloadedSound_tra = "OK";
	console.log("Downloaded: " + path + " > " + file.size);
									    		}
									    	}
									    	else
									    	{
									    		//PAS LA BONNE TAILLE => ON RECHARGE
										    	if (file.size != data_exp[pos].sound_tra_size)
										    	{
										    		if (data_exp[pos].downloadedSound_tra != "downloading")
										    		{
										    			nb_elem2dl--;
										    			data_exp[pos].downloadedSound_tra = "downloading";
	alert("---### Re-Download: " + url + " > " + path + " > " + file.size);
															downloadFile(url, path);
										    		}
										    	}
									    	}
						  				}
									},
									function (error)
									{
	console.log("ERROR GETTING FILE INFO : " + error.code);
									}
								);
							},
							function (error)
							{
	console.log("NOT EXISTS : " + path);
							}
						);
	      	}
    		}
      }

		
			function parseData(tmp_start)
			{
				var ready = true;
				window.clearInterval(timer_load);

        for (var i = tmp_start; i < nb_exp_total; i++)
				{
					if ((data_exp[i].title_id == title_id) || (exp_chk_all == true))
					{
						var str = data_exp[i].sound_tra;
						var tmp_filename = window.appRootDir.fullPath + "/" + str.substring(str.lastIndexOf("/")+1, str.length);
						if (((tmp_filename.fileExists() == false) || ((data_exp[i].date_tra > exp_last_upd_ms) && (data_exp[i].downloadedSound_tra != "OK"))) && (data_exp[i].downloadedSound_tra != "downloading"))
						{
//console.log("Audio not found : " + tmp_filename);
							ready = false;
	            data_exp[i].downloadedSound_tra = "downloading";
							downloadFile("http://www.loecsen.com/OrizonFlash_V2/ressources/son/"+str, tmp_filename);
	            break;
						}
	          else
	          {
							checkIfFileExists(tmp_filename, "http://www.loecsen.com/OrizonFlash_V2/ressources/son/"+str, i, "sound_tra");
	            if ((typeof(data_exp[i].downloadedSound_tra) == "undefined") && (data_exp[i].downloadedSound_tra != "OK"))
	            {
                //data_exp[i].downloadedSound_tra = "OK";
	              nb_elem2dl++;
//console.log(Math.round((nb_elem2dl*100/(nb_exp_total))) + "% Sound " + "n" + nb_elem2dl + " download complete: " + tmp_filename);
	              pg_value = Math.round((nb_elem2dl*100/(nb_exp_total)));
	              data_exp[i].sound_tra = tmp_filename;
	            }
	            else
	            {
		            if (data_exp[i].downloadedSound_tra == "downloading")
		            {
//console.log("Audio found (downloading) : " + tmp_filename);
		              ready = false;
//break;
		            }
	            }
	          }
          }
        }
      
				if (ready == true)
				{
					$('#grd_block2').css('background-image', 'none');
					$('#lbl_trans').css('display', 'block');
					$('#lbl_phon').css('display', 'block');
					$('#sel_exp li').remove();
					$('#sel_exp').mobiscroll('destroy');
					$('#scroller li').remove();
        	nb_exp = 0;
	        for (var i = 0; i < nb_exp_total; i++)
					{
	        	if (data_exp[i].title_id == title_id)
	        	{
	        		if (nb_exp == 0)
	        		{
	        	    cur_expID = data_exp[i].id;
	        	    start_exp=i;
	        		}
	        		nb_exp++;
							var tmp_id = data_exp[i].id;
							if (data_exp[i].variation == "N")
							{
									$('#sel_exp').append('<li data-val=" '+ tmp_id.toString() + '"><div class="exp"><span class="exp_txt">' + data_exp[i].text + '</span></div></li>');
									$('#scroller > ul').append('<li class="tab_exp" data-val=" '+ tmp_id.toString() + '" data-icon="false"><a class="tab_exp_txt" href="#">' + data_exp[i].text + '</a></li>');
							}
							else
							{
								if (from_lang_r2l == "Y")
								{
									$('#sel_exp').append('<li data-val=" '+ tmp_id.toString() + '"><div class="exp"><span class="exp_var">' + data_exp[i].desc + ' +</span></div></li>');
									$('#scroller > ul').append('<li class="tab_exp" data-val=" '+ tmp_id.toString() + '" data-icon="false"><a class="tab_exp_var" href="#">' + data_exp[i].desc + ' +</a></li>');
								}
								else
								{
									$('#sel_exp').append('<li data-val=" '+ tmp_id.toString() + '"><div class="exp"><span class="exp_var">+ ' + data_exp[i].desc + '</span></div></li>');
									$('#scroller > ul').append('<li class="tab_exp" data-val=" '+ tmp_id.toString() + '" data-icon="false"><a class="tab_exp_var" href="#">+ ' + data_exp[i].desc + '</a></li>');
								}
							}
	        	}
					}

          $('.tab_exp a').css({'width' : left_column_width-40 + 'px'});
					$('.tab_exp').click(function()
					{
						cur_expID = $.trim($(this).attr('data-val'));
						if (mode_player == true)
							upd_elem(cur_expID);
						else
						{
					    $('#btn_validate').removeClass('ui-disabled');
							$('#scroller .ui-btn-up-a').removeClass('ui-btn-up-a').removeClass('ui-btn-hover-a').addClass('ui-btn-up-d').attr('data-theme', 'd').trigger('create');
							$("[data-val=' " + cur_expID + "']").removeClass('ui-btn-up-d').removeClass('ui-btn-hover-d').addClass('ui-btn-up-a').attr('data-theme', 'a').trigger('create');
						}
				    return false;
				  });
					
          $('#scroller > ul').trigger('create');
					$('#scroller > ul').listview('refresh');
					$('#page1').css("min-height","");
					$('#page1').css("padding-bottom","");
					$('#page1').css("padding-top","");
					setup_UI();
					if (tabletView == true)
					{
						if (typeof(myScroll) != 'undefined')
							Scroll_refresh();
						else
							Scroll_create();
					}
					$('#sel_exp').mobiscroll().image({
				    theme: 'ios',
				    lang: lang,
				    display: 'inline',
				    mode: 'scroller',
				    labels: ['Expressions'],
				    inputClass: 'i-txt',
				    rows: scroller_row,
				    width: scroller_width+10,
				    onChange: function (valueText, inst){
							var sel = valueText;
							cur_expID = $.trim(sel);
							if (mode_player == true)
								upd_elem(cur_expID);
							else
							{
								upd_elem(cur_expID, false, false, false, false);
								$('#btn_validate').removeClass('ui-disabled');
							}
						}
					});
          hide_ProgressBar();
          if (mode_player == true)
          	upd_elem(cur_expID);
          else
          {
				    exp_used = new Array();
						nb_good_answers=0;
						nb_exp_used=0;
				    init_QCM();
          }
				}
        else
        {
        	//parseData(0);
          //timer_load = setTimeout(parseData(0), 2000);
        }
			}
//			ajax_get_product(from_lang_id);
//			ajax_upd_titles(prd_id, from_lang_id);
		
		
		
			$("#jquery_jplayer_1").jPlayer({
				ready: function (event) {
				},
				swfPath: "js/jplayer",
				supplied: "mp3, oga",
				wmode: "window",
				solution:"html,flash"
			});
		
			$('#img_exp').bind('swipeleft',swipe_left);
			$('#img_exp').bind('swiperight',swipe_right);
		  $('#img_exp').click(function(){
		    if (mode_player == true)
			    upd_elem(cur_expID);
			  else
			  {
			  	if (nb_exp_used < nb_exp)
			  		upd_elem(qcm_sel, false, false, false);
			  	else
		  		{
				    exp_used = new Array();
						nb_good_answers=0;
						nb_exp_used=0;
				    init_QCM();
		  		}
			  }
		    return false;
		  });
			function swipe_left(e){
				if (mode_player == true)
				{
					if (num_exp < (nb_exp + start_exp))
					{
						num_exp++;
			    	cur_expID = data_exp[num_exp].id;
			    	$('#sel_exp').mobiscroll('setValue', [' ' + cur_expID], false, 0.5);
						upd_elem(cur_expID);
						scrollToLine(num_exp - start_exp - jump, true);
					}
				}
			};
			function swipe_right(e){
				if (mode_player == true)
				{
					if (start_exp < num_exp)
					{
						num_exp--;
			    	cur_expID = data_exp[num_exp].id;
			    	$('#sel_exp').mobiscroll('setValue', [' ' + cur_expID], false, 0.5);
						upd_elem(cur_expID);
						scrollToLine(num_exp - start_exp - jump, true);
					}
				}
			};

		
			function init_QCM() {
				$('#grd_block2').css({'background-image': 'none'});
		    $('#btn_validate').addClass('ui-disabled');
				$('#scroller .ui-btn-up-a').removeClass('ui-btn-up-a').removeClass('ui-btn-hover-a').addClass('ui-btn-up-d').attr('data-theme', 'd').trigger('create');
		
				if (nb_exp_used < nb_exp)
				{
			   	$('#img_exp').svg({loadURL: 'ressources/webapp/quizz.svg', addTo: false, changeSize: false});
					$('#img_exp').svg('destroy');
			   	$('#img_exp').svg({loadURL: 'ressources/webapp/quizz.svg', addTo: false, changeSize: false});
					if (nb_exp_used > 0)
					{
				    $('#lbl_trans').html(g_UI_translated[lang_UI]["TXT_MOB_18"] + ' : ' + nb_good_answers + '  /  ' + nb_exp_used);  // TO translate
				    $('#lbl_phon').html(g_UI_translated[lang_UI]["TXT_MOB_17"] + ' : ' + nb_exp_used + '  /  ' + nb_exp);  // TO translate
				  }
				  else
					{
				    $('#lbl_trans').html('');
				    $('#lbl_phon').html('');
				  }
		
					if (nb_exp_used <= 0)
						nb_good_answers = 0;
					qcm_num = Math.floor((Math.random()*nb_exp)) + start_exp;
					while (exp_used[qcm_num] == true)
						qcm_num = Math.floor((Math.random()*nb_exp)) + start_exp;
					exp_used[qcm_num] = true;
					nb_exp_used++;
					qcm_sel = data_exp[qcm_num].id;
					upd_elem(qcm_sel, false, false, false);
				}
				else
				{
			    $('#lbl_trans').html(g_UI_translated[lang_UI]["TXT_MOB_18"] + nb_good_answers + '  /  ' + nb_exp_used);  // TO translate
			    $('#lbl_phon').html(g_UI_translated[lang_UI]["TXT_MOB_24"]);  // TO translate
			   	$('#img_exp').svg({loadURL: 'ressources/webapp/quizz-end.svg', addTo: false, changeSize: false});
					$('#img_exp').svg('destroy');
			   	$('#img_exp').svg({loadURL: 'ressources/webapp/quizz-end.svg', addTo: false, changeSize: false});
				}
			}
			
			function quizz_next()
			{
	 			$("#pup_result").popup("close");
				upd_elem(qcm_sel);
				setTimeout(init_QCM,3000);
			}
			
		  $('#btn_validate').click(function(){
		  	if ($('#btn_validate').hasClass('ui-disabled') == false)
		  	{
		  		var snd_qcm;
		  		if (qcm_sel == cur_expID)
		  		{
		  			nb_good_answers++;
			 			$("#pup_result").html('<div style="display: table-cell;"><img src="ressources/webapp/ok.png" style="vertical-align: middle; padding-right: 10px;"><span style="text-align: center; vertical-align: middle;">' + g_UI_translated[lang_UI]["TXT_MOB_16"] + '</span></div>');
		  			snd_qcm = 'ressources/webapp/yes.mp3';
		  		}
		  		else
		  		{
			 			$("#pup_result").html('<div style="display: table-cell;"><img src="ressources/webapp/nok.png" style="vertical-align: middle; padding-right: 10px;"><span style="text-align: center; vertical-align: middle;">' + g_UI_translated[lang_UI]["TXT_MOB_15"] + '</span></div>');
		  			snd_qcm = 'ressources/webapp/no.mp3';
		  		}

		  		$("#pup_result").popup("open");
		  		if (android)
		  		{
		  			setTimeout(quizz_next,1000);
		  		}
		  		else
		  		{
			  		$("#jquery_jplayer_1").bind($.jPlayer.event.ended + ".jp-ended", function(event) { // Using ".jp-ended" namespace so we can easily remove this event
			  			quizz_next();
			  			$("#jquery_jplayer_1").unbind($.jPlayer.event.ended + ".jp-ended");
						});
					  $("#jquery_jplayer_1").jPlayer("setMedia", {
					  	mp3: snd_qcm
					  }).jPlayer("play");
		  		}
				}
		    return false;
		  });
		
		  $('#btn_quizz').click(function(){
		    if (mode_player == true)
		    {
		    	mode_player = false;
		    	jump=1;
		    	$("#btn_quizz .ui-btn-text").text(g_UI_translated[lang_UI]["TXT_MOB_4"]);
		    	$("#help_content").hide();
		    	$("#help_quizzcontent").show();
					$('#btn_refresh').removeClass('ui-btn-up-b').removeClass('ui-btn-hover-b').addClass('ui-btn-up-a').attr('data-theme', 'a').trigger('create');
			    $('#btn_autoplay').hide();
			    $('#btn_validate').css({'display': 'block'});
			    $('#btn_validate').addClass('ui-first-child');
		//	    $('#btn_validate').addClass('ui-disabled');
			    
			    exp_used = new Array();
					nb_good_answers=0;
					nb_exp_used=0;
			    init_QCM();
				}
				else
				{
					jump=5;
					mode_player = true;
		    	$("#btn_quizz .ui-btn-text").text(g_UI_translated[lang_UI]["TXT_MOB_5"]);
		    	$("#help_content").show();
		    	$("#help_quizzcontent").hide();
			    $('#btn_validate').hide();
			    $('#btn_autoplay').show();
		 			$('#btn_refresh').removeClass('ui-btn-up-a').removeClass('ui-btn-hover-a').addClass('ui-btn-up-b').attr('data-theme', 'b').trigger('create');
		
		    	upd_elem(cur_expID);
				}
		
		    return false;
		  });
		
		  $('#btn_autoplay').click(function(){
				$("#jquery_jplayer_1").unbind($.jPlayer.event.ended + ".jp-ended");
		    if ($('#btn_refresh').hasClass('ui-disabled'))
		    {
		    	window.clearInterval(timer);
		    	$('#btn_refresh').removeClass('ui-disabled');
		   		$("#btn_autoplay span.ui-icon").addClass("ui-icon-play").removeClass("ui-icon-stop");
		    }
		    else
		    {
		    	$('#btn_refresh').addClass('ui-disabled');
		    	upd_elem(cur_expID);
		   		$("#btn_autoplay span.ui-icon").addClass("ui-icon-stop").removeClass("ui-icon-play");
		    }
		    return false;
		  });
		
		  $('#btn_refresh').click(function(){
		    if ($('#btn_refresh').hasClass('ui-disabled') == false)
		    {
			    if (mode_player == true)
			    	upd_elem(cur_expID);
					else
			    	upd_elem(qcm_sel, false, false, false);
			    return false;
			  }
		  });
		
		  $('#btn_from_lang').click(function(){
		    $('#sel_from_lang').mobiscroll('show');
		    $('#sel_from_lang').mobiscroll('setValue', [' ' + from_lang_id], false, 0.5);
		    return false;
		  });
		
		  $('#btn_to_lang').click(function(){
		    $('#sel_to_lang').mobiscroll('show');
		    $('#sel_to_lang').mobiscroll('setValue', [' ' + to_lang_id], false, 0.5);
		    return false;
		  });
		
		  $('#btn_title').click(function(){
		    $('#sel_title').mobiscroll('show');
		    $('#sel_title').mobiscroll('setValue', [' ' + title_id], false, 0.5);
		    return false;
		  });

		  $('#pup_newlang_btn1').click(function(){
		  	if ($('#pup_newlang_title').hasClass('from_lang'))
			  	changeLang("from_lang");
			  else
			  	changeLang("to_lang");

     		$('#pup_newlang_title').removeClass("from_lang");
     		$('#pup_newlang_title').removeClass("to_lang");
		  	$("#pup_newlang").popup("close");
		  });

		  $('#pup_newlang_btn2').click(function(){
     		$('#pup_newlang_title').removeClass("from_lang");
     		$('#pup_newlang_title').removeClass("to_lang");
		  	$("#pup_newlang").popup("close");
		  });
		
			function upd_elem(exp_id, update_img, update_txt, update_list, update_snd) {
		    num_exp = get_dataexp_pos(data_exp, exp_id, "exp");
				if (typeof(update_snd) == 'undefined')
				{
		  		$("#jquery_jplayer_1").bind($.jPlayer.event.ended + ".jp-ended", function(event) { // Using ".jp-ended" namespace so we can easily remove this event
						if ($('#btn_refresh').hasClass('ui-disabled'))
						{
							if (num_exp <= (nb_exp + start_exp))
								timer = setTimeout(swipe_left,3000);
							else
							{
					   		$("#btn_autoplay span.ui-icon").addClass("ui-icon-play").removeClass("ui-icon-delete");
					   		$('#btn_refresh').removeClass('ui-disabled');
							}
						}
						$("#jquery_jplayer_1").unbind($.jPlayer.event.ended + ".jp-ended");
					});

				  $("#jquery_jplayer_1").jPlayer("setMedia", {
				  	mp3: data_exp[num_exp].sound_tra
				  }).jPlayer("play");
				}
		
				if (typeof(update_img) == 'undefined')
				{
					$('#img_exp').svg({loadURL: 'ressources/webapp/svg/' + data_exp[num_exp].image, addTo: false, changeSize: false});
					$('#img_exp').svg('destroy');
					$('#img_exp').svg({loadURL: 'ressources/webapp/svg/' + data_exp[num_exp].image, addTo: false, changeSize: false});
			  }
		
				if (typeof(update_txt) == 'undefined')
				{
			    $('#lbl_trans').html(data_exp[num_exp].text_tra);
			    if (tabletView == false)
			    {
						$('#lbl_trans').css("font-size", "16px");
						$('#lbl_phon').css("font-size", "14px");
						if ($('#lbl_trans').height() > 20)
						{
				    	var size;
				    	while($('#lbl_trans').height() > 20)
				    	{
				    		size = parseInt($('#lbl_trans').css("font-size"), 10);
								$('#lbl_trans').css("font-size", size - 1);
							}
							$('#lbl_phon').css("font-size", size - 3.5);
						}
			    }
			    $('#lbl_phon').html(data_exp[num_exp].phonetic_tra);
			  }
		
				if (typeof(update_list) == 'undefined')
				{
					if (tabletView == true)
					{
						$('#scroller .ui-btn-up-a').removeClass('ui-btn-up-a').removeClass('ui-btn-hover-a').addClass('ui-btn-up-d').attr('data-theme', 'd').trigger('create');
						$("[data-val=' " + exp_id + "']").removeClass('ui-btn-up-d').removeClass('ui-btn-hover-d').addClass('ui-btn-up-a').attr('data-theme', 'a').trigger('create');
						if (($("#btn_autoplay span.ui-icon").hasClass("ui-icon-stop")) || (mode_player == false))
							scrollToLine(num_exp-jump, true);
						else
							scrollToLine(num_exp-jump, false);
					}
					else
					{
						if ($("#btn_autoplay span.ui-icon").hasClass("ui-icon-stop"))
			    		$('#sel_exp').mobiscroll('setValue', [' ' + exp_id], false, 0.5);
			    	if (mode_player == false)
				    	$('#sel_exp').mobiscroll('setValue', [' ' + qcm_sel], false, 0.5);
			    }
			  }
			}
		
		
		
		
			function setup_UI()
			{
				if (from_lang_r2l == 'Y')
				{
					scroller_r2l = true;
					$(".exp_txt").css({'text-align': 'right'});
					$(".exp_var").css({'text-align': 'right'});
					$(".img-cont").css({'float': 'right'});
					$(".img-cont").css({'padding-right': '5px'});
					$(".img-cont").css({'padding-left': '10px'});
					$(".list_option span").css({'float': 'right'});
					
					$(".tab_exp_txt").css({'text-align': 'right'});
					$(".tab_exp_var").css({'text-align': 'right'});
					$(".tab_exp_var").css({'margin-right': '20px'});
				}
				else
					scroller_r2l = false;

				if (tabletView == false)
				{
					$('#grd_block1').css({'display' : 'none'});
					$('#grd_block2').css({'width' : browser_width + 'px'});
					$('#grd_block3').css({'display' : 'none'});
					$('#grd_block4').css({'width' : browser_width + 'px'});
					$('#grd_block5').css({'display' : 'none'});
					$('#grd_block6').css({'width' : browser_width + 'px'});
			
					$('#topbar_left').css({'width' : '100px;', 'min-width' : '100px;', 'max-width' : '100px;'});
					$('#topbar_right').css({'width' : '100px;'});
					$('#bar_left').css({'width' : '130px;'});
					$('#bar_right').css({'width' : '90px;'});
			
					$(".exp_txt").width(scroller_width);
					$(".exp_var").width(scroller_width-20);
			
					var img_width = browser_width;
					var img_height = img_width*img_ratio;
					var bar_width = browser_width;
			
					//$('#ads').css({'display' : 'none'});
//					$('#tab_ads').css({'display' : 'none'});
			
			
//	alert(browser_height + " / header: " + $('#page_header').height() + " / " + 38 + " / img: " + img_height + " / ads: " + $('#ads').height() + " / " + $('#bar_left').height() + " / " + $('#grd_block6:nth-child(3)').height());
/* ADS */
          var cnt_padding = (((browser_height)  - (44 + 38 + img_height + 50 + 41 + (scroller_row * 30) + 18)) / 2);
/*NO ADS */
//          var cnt_padding = (((browser_height)  - (44 + 38 + img_height + 41 + (scroller_row * 30) + 18)) / 2);
          $('#cnt_exp').css({'padding-top': cnt_padding + 'px', 'padding-bottom': cnt_padding + 'px'});

//alert(cnt_padding);
					
				}
				else
				{
					var left_column_width = 327;
          if (android)
            var main_vertical_margins = 75;
          else
            var main_vertical_margins = 100;
          var img_width = browser_width - left_column_width;
					var img_height = img_width*img_ratio;
					var bar_width = browser_width;
					var lbl_trans_height = 30;
					var lbl_phon_height = 27;
			
					$('#lbl_trans').css({'height' : lbl_trans_height + 'px'});
					$('#lbl_trans').css({'font-size' : 24 + 'px'});
					$('#lbl_trans').css({'padding-top': (main_vertical_margins / 2) + 'px', 'padding-bottom': '0px'});
					$('#lbl_phon').css({'height' : lbl_phon_height + 'px'});
					$('#lbl_phon').css({'font-size' : 20 + 'px'});
					$('#lbl_phon').css({'padding-top': '0px', 'padding-bottom': (main_vertical_margins) + 'px'});
					
//					var main_row_height = img_height + 60 + lbl_trans_height + lbl_phon_height + (main_vertical_margins*2.5);
					var main_row_height = browser_height-41-41;
					$('#grd_block1').css({'width' : left_column_width + 'px'});
					$('#grd_block1').css({'height' : main_row_height + 'px'});
					$('#grd_block2').css({'width' : browser_width-$('#grd_block1').width() + 'px'});
					$('#grd_block2').css({'height' : main_row_height + 'px'});
					$('#grd_block3').css({'display' : 'none'});
					$('#grd_block4').css({'width' : browser_width + 'px'});
					$('#grd_block5').css({'display' : 'none'});
					$('#grd_block6').css({'display' : 'none'});
			
					$('#topbar_left').css({'width' : '100px'});
					$('#topbar_right').css({'width' : '100px'});
			//		$("#topbar_center div").css({'padding-top': '5px'});
					$('#bar_left').css({'width' : '160px'});
					$('#bar_right').css({'width' : '90px'});
			
					$('#list_exp').css({'width' : left_column_width + 'px'});
/* ADS */
					$('#list_exp').css({'height' : main_row_height-54 + 'px'});
/*NO ADS */
//					$('#list_exp').css({'height' : main_row_height + 'px'});
					$('#scroller').css({'width' : left_column_width-8 + 'px'});
			
					$('.tab_exp a').css({'width' : left_column_width-40 + 'px'});
/*
          $('.tab_exp').click(function()
					{
						cur_expID = $(this).attr('data-val');
						if (mode_player == true)
							upd_elem(cur_expID);
						else
						{
					    $('#btn_validate').removeClass('ui-disabled');
							$('#scroller .ui-btn-up-a').removeClass('ui-btn-up-a').removeClass('ui-btn-hover-a').addClass('ui-btn-up-d').attr('data-theme', 'd').trigger('create');
							$("[data-val=' " + cur_expID + "']").removeClass('ui-btn-up-d').removeClass('ui-btn-hover-d').addClass('ui-btn-up-a').attr('data-theme', 'a').trigger('create');
						}
				    return false;
				  });
*/
/*NO ADS */
					$('#tab_ads').css({'top' : main_row_height-54 + 'px', 'width' : left_column_width + 'px'});
					$('#ads').css({'display' : 'none'});
			
					$('#cnt_exp').css({'padding-top': '0px', 'padding-bottom': main_vertical_margins + 'px'});
				}
			
			
				$('#footer').css({'height': browser_height-40 + 'px'});
			
				$('#topbar_center').css({'width': browser_width - $('#topbar_left').width() - $('#topbar_right').width() + 'px'});
				$('#top_title').css({'width': browser_width - $('#topbar_left').width() - $('#topbar_right').width() + 'px'});
				$('#topbar_center > div').css({'display': 'table-cell'});
				$('#bar_center').css({'width': bar_width - $('#bar_left').width() - $('#bar_right').width() + 'px'});
			
				$('#img_exp').css({'width': img_width});
				$('#img_exp').css({'height': img_height});
				$("#pup_result").popup({positionTo: $('#img_exp')});
				
				$("#pnl_share").trigger("updatelayout");
			}
			setup_UI();

		//	ajax_upd_expressions(prd_id, from_lang_id, to_lang_id, title_id);
		//	upd_elem(cur_expID);
		});
		</script>
	</head>
	<body>
		<script src="phonegap.js"></script>
		<!-- Home -->
		<div data-role="page" id="page1">
	
			<div data-role="panel" id="pnl_share" data-position="right" data-display="push" data-theme="a">
					<ul data-role="listview" data-inset="true" data-theme="c" data-divider-theme="c">
						<li id="TXT_MOB_19" data-role="list-divider">Partager</li>
						<li data-icon="false" onclick="var ref = window.open('http://www.facebook.com/sharer/sharer.php?u=' + encodeURIComponent(share_url), '_system');" class="list_share">
								<div><img src="images/icon_facebook_32x32.png" alt="Facebook" class="ui-li-thumb"><span>Facebook</span></div>
						</li>
						<li data-icon="false" class="list_share" onclick="var ref = window.open('https://twitter.com/intent/tweet?text=' + encodeURIComponent('Loecsen') + '&url=' + encodeURIComponent(share_url), '_system');">
								<div><img src="images/icon_twitter_32x32.png" alt="Twitter" class="ui-li-thumb"><span>Twitter</span></div>
						</li>
						<li data-icon="false" class="list_share" onclick="var ref = window.open('https://plus.google.com/share?url=' + encodeURIComponent(share_url), '_system');">
							<div><img src="images/icon_googleplus_32x32.png" alt="Google" class="ui-li-thumb"><span>Google</span></div>
						</li>
						<li data-icon="false" class="list_share" onclick="var ref = window.open('http://www.linkedin.com/shareArticle?mini=true&url=' + encodeURIComponent(share_url) + '&title=' + encodeURIComponent('Loecsen') + '&summary=' + encodeURIComponent('Loecsen'), '_system');">
								<div><img src="images/icon_linkedin_32x32.png" alt="LinkedIn" class="ui-li-thumb"><span>LinkedIn</span></div>
						</li>
						<li data-icon="false" class="list_share" onclick="var ref = window.open('mailto:contact@loecsen.com', '_system');">
								<div><img src="images/icon_email_32x32.png" alt="Email" class="ui-li-thumb"><span>Email</span></div>
						</li>
					</ul>
				  <a id="TXT_MOB_20" href="#pnl_share" data-role="button" data-rel="close" data-theme="a">Fermer</a>
			</div>
	
			<div id="page_header" class="my-header-grid ui-grid-b" data-theme="a" data-role="header" data-position="fixed">
				<div id="topbar_left" class="ui-block-a ui-bar-a" data-theme="a" style="width: 100px;">
					<div align="left" style="padding-left:2px; padding-top:0px; height:40px;">
						<div  onclick="var ref = window.open(share_url, '_system');"><a id="TXT_MOB_23" id="btn_premium" data-role="button" data-inline="true" data-mini="true" data-theme="b">Loecsen</a></div>
					</div>
				</div>
				<div id="topbar_center" class="ui-block-b ui-bar-a">
					<div style="text-align:center; vertical-align: middle; height: 40px; display:table-cell;">
						<div id="top_title" style="vertical-align: middle; text-align: center; font-size: 14px; font-weight: bold;">Lexique</div>
					</div>
				</div>
				<div id="topbar_right" class="ui-block-c ui-bar-a" style="width: 100px;">
					<div align="right" style="height:40px;">
						<div data-role="controlgroup" data-type="horizontal" data-mini="true">
							<a id="btn_info" href="#infoPage" data-rel="popup" data-position-to="window" data-role="button" data-inline="true" data-mini="true" data-iconpos="notext" data-icon="help" data-theme="a">Info</a>
							<a href="#pnl_share" id="btn_share" data-role="button" data-inline="true" data-mini="true" data-theme="a"><img id="icon_share" src="ressources/webapp/icon_share2.png" style="margin-top:-3px; width:23px;" /></a>
						</div>
					</div>
				</div>

				<!-- Info -->
				<div data-role="popup" id="infoPage" data-corners="false">
					<a href="#" data-rel="back" data-role="button" data-theme="e" data-icon="delete" data-iconpos="notext" class="ui-btn-right">Fermer</a>
				  <div data-role="header" data-theme="e">
				    <h2 id="TXT_MOB_7">Aide</h2>
				  </div>
				  <div data-role="content" data-theme="e">
				  	<div id="help_content" style="width: 260px;">
							<div style="width: 100%; height: 50px;">
								<div style="float: left; width: 100px;">
									<div data-role="controlgroup" data-type="horizontal" data-mini="true">
										<a href="#" id="btn_from_lang_demo" data-role="button" data-inline="true" data-mini="true" data-theme="a"><img id="flag1" class="img_flag" src="images/flags/fr.gif" /></a>
						    		<a href="#" id="btn_to_lang_demo" data-role="button" data-inline="true" data-mini="true" data-theme="a"><img id="flag2" class="img_flag" src="images/flags/uk.gif" /></a>
						    	</div>
					    	</div>
					    	<span id="TXT_MOB_8">Changer les langues de d&eacute;part et d&acute;arriv&eacute;e</span>
					    </div>
							<div style="width: 100%; height: 50px;">
								<div style="float: left; width: 50px;">
									<div data-role="controlgroup" data-type="horizontal" data-mini="true">
						    		<a href="#" id="btn_title_demo" data-role="button" data-inline="true" data-mini="true" data-iconpos="notext" data-icon="bars" data-theme="a"></a>
									</div>
						    </div>
						    <span id="TXT_MOB_9" style="margin-top: 10px; display: inline-block;">Changer le th&egrave;me</span>
					    </div>
							<div style="width: 100%; height: 50px;">
								<div style="float: left; width: 50px;">
									<div data-role="controlgroup" data-type="horizontal" data-mini="true">
										<a href="#" id="btn_autoplay_demo" data-role="button" data-iconpos="notext" data-icon="play" data-theme="b">Autoplay</a>
									</div>
						    </div>
						    <span id="TXT_MOB_10" style="margin-top: 10px; display: inline-block;">Lecture continue</span>
					    </div>
							<div style="width: 100%; height: 50px;">
								<div style="float: left; width: 50px;">
									<div data-role="controlgroup" data-type="horizontal" data-mini="true">
										<a href="#" id="btn_refresh_demo" data-role="button" data-iconpos="notext" data-icon="refresh" data-theme="b">Refresh</a>
									</div>
						    </div>
						    <span id="TXT_MOB_11" style="margin-top: 10px; display: inline-block;">Rejouer</span>
					    </div>
					  </div>
				  	<div id="help_quizzcontent" style="width: 260px; display: none;">
							<ol>
								<li id="TXT_MOB_12">Ecoutez l&acute;expression</li>
								<li id="TXT_MOB_13">Choisissez une r&eacute;ponse dans la liste des expressions</li>
								<li id="TXT_MOB_14">Validez votre r&eacute;ponse</li>
							</ol><hr/>
							<div style="width: 100%; height: 50px;">
								<div style="float: left; width: 50px;">
									<div data-role="controlgroup" data-type="horizontal" data-mini="true">
										<a href="#" id="btn_validate_demo" data-role="button" data-iconpos="notext" data-icon="check" data-theme="b">Validate</a>
									</div>
						    </div>
						    <span id="TXT_MOB_29" style="margin-top: 10px; display: inline-block;">Valider</span>
					    </div>
							<div style="width: 100%; height: 50px;">
								<div style="float: left; width: 50px;">
									<div data-role="controlgroup" data-type="horizontal" data-mini="true">
										<a href="#" id="btn_refresh_demo2" data-role="button" data-iconpos="notext" data-icon="refresh" data-theme="b">Refresh</a>
									</div>
						    </div>
						    <span id="TXT_MOB_11" style="margin-top: 10px; display: inline-block;">Rejouer</span>
					    </div>
						</div>
				  </div>
				</div>
				<!-- /Info -->
				<div data-role="popup" id="pup_newlang" data-overlay-theme="a" data-theme="c" data-dismissible="false" style="width:300px; max-width:300px;" class="ui-corner-all">
					<div data-role="header" data-theme="a" class="ui-corner-top">
						<h1 id="pup_newlang_title">Confirmation</h1>
					</div>
					<div data-role="content" data-theme="d" class="ui-corner-bottom ui-content">
						<p style="text-align: justify"><span id="pup_newlang_txt1">La langue que vous avez s&eacute;lectionn&eacute;e n'a pas encore &eacute;t&eacute; install&eacute;e sur votre syst&egrave;me.</span><br/><span id="pup_newlang_txt2">Ce t&eacute;l&eacute;chargement est gratuit et pourra occuper jusqu'à 15Mo d'espace.</span><br/><br/><span id="pup_newlang_txt3">Voulez-vous lancer le t&eacute;l&eacute;chargement maintenant ?</span></p>
						<a id="pup_newlang_btn1" href="#" data-role="button" data-inline="true" data-theme="c" style="width: 120px;">Oui</a>    
						<a id="pup_newlang_btn2" href="#" data-role="button" data-inline="true" data-theme="b" style="width: 120px;">Non</a>  
					</div>
				</div>
			</div>
<!--
			<div data-role="content" style="padding: 0; height: 0px; background-color: #FFFFFF">
			</div>
-->
			<div id="footer" data-theme="a" data-role="footer" data-position="fixed" style=" padding-bottom:0px; border-top-width: 0; background-color: #FFFFFF;">
				<div id="grd_main" class="ui-grid-a2">
					<div id="grd_block1" class="ui-block-a">
	<!-------------------- BLOCK 1 ui-bar ui-bar-e -------------------->
						<div id="list_exp" style="background-repeat:repeat-y; background-image:url(images/bg_scroll_list_exp.jpg);">
							<div id="scroller">
								<ul data-role="listview" data-inset="false" data-theme="d" data-divider-theme="d">
								</ul>
							</div>
						</div>
							<div id="tab_ads" style="position: absolute; background-color:#FFFFFF; z-index: 999"></div>
					</div>
					<div id="grd_block2" class="ui-block-b" style="background-color: #FFFFFF; background-repeat:no-repeat; background-position: center center; background-image:url(images/loader.gif);">
	<!-------------------- BLOCK 2 ui-bar ui-bar-e -------------------->
						<div class="" style="">
	
							<div id="cnt_exp" style="text-align: center">
								<h4 id="lbl_trans" class="exp_trans" style="display: none;"> </h4>
								<h5 id="lbl_phon" class="exp_phon" style="display: none;"></h5>
								<div id="img_exp"></div>
								<div id="pup_result" data-role="popup" class="ui-content" style="width: 200px; max-width:350px;"></div>
							</div>
              
               <div id="ads" style="margin:auto; height: 50px; text-align:center; background-color:#FFCC66"></div>
						</div>
					</div>
	<!-------------------- BLOCK 3 ui-bar ui-bar-e -------------------->
					<div id="grd_block3" class="ui-block-a">
						<div class="" style=""></div>
					</div>
	<!-------------------- BLOCK 4 ui-bar ui-bar-e -------------------->
					<div id="grd_block4" class="ui-block-b" style="opacity: 0.9">
						<div id="pg_bar" style="display: none">
							<input type="range" name="slider-mini" id="slider-mini" value="0" min="0" max="100" data-highlight="true" data-mini="true" />
						</div>
						<div class="" style="">
							<div id="bar" class="my-header-grid ui-grid-b" data-theme="a">
								<div id="bar_left" class="ui-block-a ui-bar-a" style="width: 130px;">
									<div align="left" style="padding-left:5px; padding-top:3px; height:38px;">
										<div data-role="controlgroup" data-type="horizontal" data-mini="true">
											<a href="#" id="btn_from_lang" data-role="button" data-inline="true" data-mini="true" data-theme="a"><img id="flag1" class="img_flag" src="" /></a>
							    		<a href="#" id="btn_to_lang" data-role="button" data-inline="true" data-mini="true" data-theme="a"><img id="flag2" class="img_flag" src="" /></a>
							    		<a href="#" id="btn_title" data-role="button" data-inline="true" data-mini="true" data-iconpos="notext" data-icon="bars" data-theme="a">Theme</a>
							    	</div>
									</div>
								</div>
								<div id="bar_center" class="ui-block-b ui-bar-a">
									<div align="center" style="padding-top:3px; text-align:center; height:38px;">
										<div style="padding-top:0px;">
											<a id="btn_quizz" href="#" data-role="button" data-inline="true" data-mini="true" style="">Quizz</a>
										</div>
									</div>
								</div>
								<div id="bar_right" class="ui-block-d ui-bar-a" style="width: 90px;">
									<div align="right">
										<div id="cgr_play" style="padding-top:3px;" data-role="controlgroup" data-type="horizontal" data-mini="true">
											<a href="#" id="btn_autoplay" data-role="button" data-iconpos="notext" data-icon="arrow-r" data-theme="b">Autoplay</a>
											<a href="#" id="btn_validate" data-role="button" data-iconpos="notext" data-icon="check" data-theme="b" style="display: none;">Validate</a>
											<a href="#" id="btn_refresh" data-role="button" data-iconpos="notext" data-icon="refresh" data-theme="b">Refresh</a>
										</div>
									</div>
								</div>
							</div>
            </div>
					</div>
	<!-------------------- BLOCK 5 ui-bar ui-bar-e -------------------->
					<div id="grd_block5" class="ui-block-a">
						<div class="" style=""></div>
					</div>
	<!-------------------- BLOCK 6 ui-bar ui-bar-e -------------------->
					<div id="grd_block6" class="ui-block-b2">
						<div class="" style="">
							<ul id="sel_exp" style="list-style-type:none;">
							<li data-val="0"><div class="exp"><span class="exp_txt"></span></div></li>
							<li data-val="1"><div class="exp"><span class="exp_txt"></span></div></li>
							<li data-val="2"><div class="exp"><span class="exp_txt"></span></div></li>
							<li data-val="3"><div class="exp"><span class="exp_txt"></span></div></li>
							<li data-val="4"><div class="exp"><span class="exp_txt"></span></div></li>
							<li data-val="5"><div class="exp"><span class="exp_txt"></span></div></li>
							<li data-val="6"><div class="exp"><span class="exp_txt"></span></div></li>
							<li data-val="7"><div class="exp"><span class="exp_txt"></span></div></li>
							<li data-val="8"><div class="exp"><span class="exp_txt"></span></div></li>
							<li data-val="9"><div class="exp"><span class="exp_txt"></span></div></li>
							<li data-val="10"><div class="exp"><span class="exp_txt"></span></div></li>
							<li data-val="11"><div class="exp"><span class="exp_txt"></span></div></li>
							</ul>
						</div>
					</div>
				</div>
	
				<div id="jquery_jplayer_1" class="jp-jplayer"></div>
				<div id="jp_container_1" class="jp-audio" style="display:none;">
					<div class="jp-type-single">
						<div class="jp-gui jp-interface">
							<ul class="jp-controls">
								<li><a href="javascript:;" class="jp-play" tabindex="1">play</a></li>
								<li><a href="javascript:;" class="jp-pause" tabindex="1">pause</a></li>
								<li><a href="javascript:;" class="jp-stop" tabindex="1">stop</a></li>
							</ul>
						</div>
						<div class="jp-no-solution">
							<span>Update Required</span>
							To play the media you will need to either update your browser to a recent version or update your <a href="http://get.adobe.com/flashplayer/" target="_blank">Flash plugin</a>.
						</div>
					</div>
				</div>
				<ul id="sel_from_lang">
				</ul>
				<ul id="sel_to_lang">
				</ul>
				<ul id="sel_title">
				</ul>
			</div>
		</div>
	</body>
</html>